<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Writeup of web3 challenge of 404CTF 2022 - the public key. The goal of the challenge was to retrieve the address in the storage and then find the public key of the address."><title>Writeup 404CTF 2022 - public key (web3)</title><link rel=canonical href=https://nodauf.dev/p/writeup-404ctf-2022-public-key-web3/><link rel=stylesheet href=/scss/style.min.ac77dcf8b111b51da39a92990f431923f210f3876d85798a2125667f96dc33a4.css><meta property="og:title" content="Writeup 404CTF 2022 - public key (web3)"><meta property="og:description" content="Writeup of web3 challenge of 404CTF 2022 - the public key. The goal of the challenge was to retrieve the address in the storage and then find the public key of the address."><meta property="og:url" content="https://nodauf.dev/p/writeup-404ctf-2022-public-key-web3/"><meta property="og:site_name" content="Nodauf"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="foundry"><meta property="article:tag" content="solidity"><meta property="article:tag" content="golang"><meta property="article:tag" content="web3"><meta property="article:published_time" content="2022-06-10T00:00:00+00:00"><meta property="article:modified_time" content="2022-06-10T00:00:00+00:00"><meta property="og:image" content="https://nodauf.dev/images/404CTF.png"><meta name=twitter:title content="Writeup 404CTF 2022 - public key (web3)"><meta name=twitter:description content="Writeup of web3 challenge of 404CTF 2022 - the public key. The goal of the challenge was to retrieve the address in the storage and then find the public key of the address."><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://nodauf.dev/images/404CTF.png"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><div class=site-meta><h1 class=site-name><a href=/>Nodauf</a></h1><h2 class=site-description>Pentester, perpetual student and security enthusiast. Passionnate about security, AD and more ...</h2></div></header><ol class=social-menu><li><a href=https://github.com/nodauf target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com/nodauf target=_blank title=Twitter><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/writeup-404ctf-2022-public-key-web3/><img src=/images/404CTF.png loading=lazy alt="Featured image of post Writeup 404CTF 2022 - public key (web3)"></a></div><div class=article-details><header class=article-category><a href=/categories/ctf/ style=background-color:#26a0f0;color:#fff>CTF writeups</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/writeup-404ctf-2022-public-key-web3/>Writeup 404CTF 2022 - public key (web3)</a></h2><h3 class=article-subtitle>Writeup of web3 challenge of 404CTF 2022 - the public key. The goal of the challenge was to retrieve the address in the storage and then find the public key of the address.</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Jun 10, 2022</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>6 minute read</time></div></footer></div></header><section class=article-content><h1 id=statement>Statement</h1><blockquote><p>The challenge statement is as follows:</p><p>Agent, nous vous avons préparé un exercice pour vérifier votre compréhension de la blockchain.En effet, l&rsquo;aspect pratique est important mais la partie théorique l&rsquo;est tout autant.Essayez de récupérer cette clé publique.</p><p>Contrat à l&rsquo;adresse : 0x9Eb8F52b22024003C1312ea1569cf14208f3c30A</p><p>Réseau de test Ropsten</p><p>Attention, ce challenge utilise une blockchain de test (réseau Ropsten).
En AUCUN CAS vous ne devez utiliser de réelles cryptomonnaies pour ce challenge.
Nous ne sommes pas responsables des éventuelles pertes que vous pourriez subir si vous le faites.
Si vous possédez de réelles cryptomonnaies, nous vous conseillons fortement de créer un nouveau wallet séparé et dédié à ces challenges.</p></blockquote><p>The source code of the smart contract is given:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-solidity data-lang=solidity><span class=line><span class=cl><span class=k>pragma solidity</span> <span class=mi>0</span><span class=p>.</span><span class=mi>8</span><span class=p>.</span><span class=mi>13</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>contract</span> <span class=nc>publicKey</span><span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>address</span> <span class=k>private</span> <span class=n>secretAddress</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>constructor</span><span class=p>(</span><span class=kt>address</span> <span class=n>_secretAddress</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=n>secretAddress</span> <span class=o>=</span> <span class=n>_secretAddress</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>isPublicKey</span><span class=p>(</span><span class=kt>bytes</span> <span class=k>memory</span> <span class=n>mystery</span><span class=p>)</span> <span class=k>external</span> <span class=k>view</span> <span class=k>returns</span><span class=p>(</span><span class=kt>bool</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=nb>require</span><span class=p>(</span><span class=kt>address</span><span class=p>(</span><span class=kt>uint160</span><span class=p>(</span><span class=kt>uint256</span><span class=p>(</span><span class=nb>keccak256</span><span class=p>(</span><span class=n>mystery</span><span class=p>))))</span> <span class=o>==</span> <span class=n>secretAddress</span><span class=p>,</span> <span class=s>&#34;Essayez encore !&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=exploitation>Exploitation</h1><p>The source code is short and contains one variable and one function. Before explaining the source code when need to understand how the address, public key and private key work in Solidity.</p><p>There are three steps to generate a new wallet:</p><ul><li>First, a <strong>private key</strong> is generated, it is composed of <strong>64 hexadecimal characters</strong> (i.e fad9c8855b740a0b7ed4c221dbad0f33a83a49cad6b3fe8d5817ac83d38b6a19).</li><li>Then, from the private key with the algorithm ECDSA, the <strong>public key</strong> is generated, it is composed of <strong>128 hexadecimal characters</strong> (i.e 9a7df67f79246283fdc93af76d4f8cdd62c4886e8cd870944e817dd0b97934fdd7719d0810951e03418205868a5c1b40b192451367f28e0088dd75e15de40c05). Sometimes the <strong>public key</strong> can be compressed to save memory space (<a class=link href=https://ethereum.stackexchange.com/questions/103482/what-is-the-difference-between-compressed-and-uncompressed-public-key target=_blank rel=noopener>source</a>)</li><li>Finally, the wallet <strong>address</strong> is generated from the <strong>public key</strong>. In solidity, this can be done as follows <code>address(uint160(uint256(keccak256(publickey))))</code>. This code takes the keccak256 hash of the public key and converts it to a 160-bit number. This number is then converted to a 20-byte address. For example, the <code>keccack256</code> of the previous public key is 793d56a696967d8f0833fd6296216849c49358b10257cb55b28ea603c874b05e (<a class=link href=https://emn178.github.io/online-tools/keccak_256.html target=_blank rel=noopener>several tools online can get the keccack256 hash</a>). The address is the last 40 characters (96216849c49358b10257cb55b28ea603c874b05e)</li></ul><p>By knowing all this, the <code>isPublicKey</code> function takes a public key as parameter, get the address from it and compare it with the <code>secretAddress</code> variable.</p><p>The exploitation can be done in two steps.</p><ol><li>Retrieving the secretAddress variable
In solidity contract nothing is really private. Even if the visibility of the variable has been set to private, the variable is still accessible. Web3 clients has a method called <code>StorageAt</code> (or something similar depending of the language) that can be used to retrieve a hex string at a specific slot in the contract.</li></ol><p>Beforehand, I forked the blockchain for faster performance and easier debugging.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>npx hardhat node --fork https://ropsten.infura.io/v3/&lt;APIKEY&gt;
</span></span><span class=line><span class=cl><span class=c1>#or</span>
</span></span><span class=line><span class=cl>anvil --fork-url https://ropsten.infura.io/v3/&lt;APIKEY&gt;
</span></span></code></pre></td></tr></table></div></div><p>The storage can be retrieved with cast from foundry:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cast storage 0x9Eb8F52b22024003C1312ea1569cf14208f3c30A <span class=m>0</span>
</span></span><span class=line><span class=cl>0x000000000000000000000000cf9a54585b20041ac1265ad64ce21d09fd4b1324
</span></span></code></pre></td></tr></table></div></div><p>or in golang</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;context&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;encoding/hex&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;errors&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;flag&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;log&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;math/big&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/ethereum/go-ethereum/common&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/ethereum/go-ethereum/crypto&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/ethereum/go-ethereum/ethclient&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>fork</span> <span class=kt>bool</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>blockchainURL</span><span class=p>,</span> <span class=nx>contractAddress</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>	<span class=nx>flag</span><span class=p>.</span><span class=nf>BoolVar</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>fork</span><span class=p>,</span> <span class=s>&#34;fork&#34;</span><span class=p>,</span> <span class=kc>true</span><span class=p>,</span> <span class=s>&#34;Should we use the parameter for the fork blockchain ? (default: true)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>flag</span><span class=p>.</span><span class=nf>Parse</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=nx>contractAddress</span> <span class=p>=</span> <span class=s>&#34;0x9Eb8F52b22024003C1312ea1569cf14208f3c30A&#34;</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>fork</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>blockchainURL</span> <span class=p>=</span> <span class=s>&#34;http://127.0.0.1:8545&#34;</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>blockchainURL</span> <span class=p>=</span> <span class=s>&#34;https://ropsten.infura.io/v3/&lt;APIKEY&gt;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nx>client</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>ethclient</span><span class=p>.</span><span class=nf>Dial</span><span class=p>(</span><span class=nx>blockchainURL</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>log</span><span class=p>.</span><span class=nf>Fatal</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=c1>// Contract
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>contractAddressHash</span> <span class=o>:=</span> <span class=nx>common</span><span class=p>.</span><span class=nf>HexToAddress</span><span class=p>(</span><span class=nx>contractAddress</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>storageContent</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>client</span><span class=p>.</span><span class=nf>StorageAt</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>Background</span><span class=p>(),</span> <span class=nx>contractAddressHash</span><span class=p>,</span> <span class=nx>common</span><span class=p>.</span><span class=nf>BigToHash</span><span class=p>(</span><span class=nx>big</span><span class=p>.</span><span class=nf>NewInt</span><span class=p>(</span><span class=mi>0</span><span class=p>)),</span> <span class=kc>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;secretAddress:&#34;</span><span class=p>,</span> <span class=nx>common</span><span class=p>.</span><span class=nf>Bytes2Hex</span><span class=p>(</span><span class=nx>storageContent</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>which returns the same value. We know that the <code>secretAddress</code> is <code>0xcf9a54585b20041ac1265ad64ce21d09fd4b1324</code>.</p><ol start=2><li>An important thing about a transaction on the blockchain, is that <strong>each transaction</strong> is <strong>signed</strong> with the private key of the sender. The <strong>sender&rsquo;s public key</strong> is also included in the <strong>signature</strong>. If the node is not able to verify the signature, it will not accept the transaction. At this point, if the address <code>0xcf9a54585b20041ac1265ad64ce21d09fd4b1324</code> has sent a transaction, we will be able to retrieve its public key. Lucky we are, it has sent four transactions (<a class=link href=https://ropsten.etherscan.io/address/0xcf9a54585b20041ac1265ad64ce21d09fd4b1324 target=_blank rel=noopener>ropsten.etherscan.io</a>).</li></ol><p>We need to recover the raw transaction that has been send by <code>0xcf9a54585b20041ac1265ad64ce21d09fd4b1324</code>. For some unknown reason etherscan can&rsquo;t <a class=link href="https://ropsten.etherscan.io/getRawTx?tx=0x0a9a1a08bd3beda768824b667573436893912c97931ce18b240ed478216f458d" target=_blank rel=noopener>retrieve the raw transaction</a>.</p><p>But we can do it with any language with a web3 module.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl>	<span class=c1>// Get the raw transaction in hex
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>txHash</span> <span class=o>:=</span> <span class=nx>common</span><span class=p>.</span><span class=nf>HexToHash</span><span class=p>(</span><span class=s>&#34;0x3e641c314c4ffdfedad05dcee63910aa846711730b0c7366feb635b2e16b5cdb&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>tx</span><span class=p>,</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>client</span><span class=p>.</span><span class=nf>TransactionByHash</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>Background</span><span class=p>(),</span> <span class=nx>txHash</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>rawTXBytes</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>tx</span><span class=p>.</span><span class=nf>MarshalBinary</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Raw data =&gt;&#34;</span><span class=p>,</span> <span class=nx>common</span><span class=p>.</span><span class=nf>Bytes2Hex</span><span class=p>(</span><span class=nx>rawTXBytes</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Raw data =&gt; f89702850ba43b7400831e84809465b38460c75a116f2b20f7bad96d2f1847db576288016345785d8a0000aa426f6e6e65206368616e636520706f75722074726f75766572206d6120636cc3a9207075626c697175651ba07f1e563c8c68bc5ef8e8556ef50d3d60159542a155f31602f0672b3f2b46a4a3a05c99f08fee4db681b60e0647a94fd9ae016476397d56b6c4d9afcc77615bb1e4
</span></span></code></pre></td></tr></table></div></div><p><a class=link href=https://toolkit.abdk.consulting/ethereum#rlp,recover-address target=_blank rel=noopener>An online tool</a> can do the math for us to retrieve the public key from the transaction.</p><p><img src=/p/writeup-404ctf-2022-public-key-web3/toolkit.abdk.consulting.png width=1457 height=741 srcset="/p/writeup-404ctf-2022-public-key-web3/toolkit.abdk.consulting_hue340c45c31f5fa55b0733d2c93848f73_88725_480x0_resize_box_3.png 480w, /p/writeup-404ctf-2022-public-key-web3/toolkit.abdk.consulting_hue340c45c31f5fa55b0733d2c93848f73_88725_1024x0_resize_box_3.png 1024w" loading=lazy alt="Retrieve the public key with an online tool" class=gallery-image data-flex-grow=196 data-flex-basis=471px></p><p>In golang, no public function is available to recover the public key of a transaction. However, a private function in <a class=link href=https://github.com/ethereum/go-ethereum/blob/4b309c70065e68321f6ba518f35b0454a5c929a9/core/types/transaction_signing.go#L482 target=_blank rel=noopener>transaction_signing</a> named <code>recoverPlain</code> return, from the raw transaction, the address of the sender after calculating the public key (I leave as an exercice for the reader to see how the internal works. The first called function is <a class=link href=https://github.com/ethereum/go-ethereum/blob/4b309c70065e68321f6ba518f35b0454a5c929a9/core/types/transaction_signing.go#L184 target=_blank rel=noopener>Sender of the london signer type</a>)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;context&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;errors&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;flag&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;log&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;math/big&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/ethereum/go-ethereum/common&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/ethereum/go-ethereum/core/types&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/ethereum/go-ethereum/crypto&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/ethereum/go-ethereum/ethclient&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>fork</span> <span class=kt>bool</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>blockchainURL</span><span class=p>,</span> <span class=nx>contractAddress</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>	<span class=nx>flag</span><span class=p>.</span><span class=nf>BoolVar</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>fork</span><span class=p>,</span> <span class=s>&#34;fork&#34;</span><span class=p>,</span> <span class=kc>true</span><span class=p>,</span> <span class=s>&#34;Should we use the parameter for the fork blockchain ? (default: true)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>flag</span><span class=p>.</span><span class=nf>Parse</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=nx>contractAddress</span> <span class=p>=</span> <span class=s>&#34;0x9Eb8F52b22024003C1312ea1569cf14208f3c30A&#34;</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>fork</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>blockchainURL</span> <span class=p>=</span> <span class=s>&#34;http://127.0.0.1:8545&#34;</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>blockchainURL</span> <span class=p>=</span> <span class=s>&#34;https://ropsten.infura.io/v3/&lt;APIKEY&gt;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nx>client</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>ethclient</span><span class=p>.</span><span class=nf>Dial</span><span class=p>(</span><span class=nx>blockchainURL</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>log</span><span class=p>.</span><span class=nf>Fatal</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=c1>// Contract
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>contractAddressHash</span> <span class=o>:=</span> <span class=nx>common</span><span class=p>.</span><span class=nf>HexToAddress</span><span class=p>(</span><span class=nx>contractAddress</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>storageContent</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>client</span><span class=p>.</span><span class=nf>StorageAt</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>Background</span><span class=p>(),</span> <span class=nx>contractAddressHash</span><span class=p>,</span> <span class=nx>common</span><span class=p>.</span><span class=nf>BigToHash</span><span class=p>(</span><span class=nx>big</span><span class=p>.</span><span class=nf>NewInt</span><span class=p>(</span><span class=mi>0</span><span class=p>)),</span> <span class=kc>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;secretAddress:&#34;</span><span class=p>,</span> <span class=nx>common</span><span class=p>.</span><span class=nf>Bytes2Hex</span><span class=p>(</span><span class=nx>storageContent</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// Get the raw transaction in hex
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>txHash</span> <span class=o>:=</span> <span class=nx>common</span><span class=p>.</span><span class=nf>HexToHash</span><span class=p>(</span><span class=s>&#34;0x3e641c314c4ffdfedad05dcee63910aa846711730b0c7366feb635b2e16b5cdb&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>tx</span><span class=p>,</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>client</span><span class=p>.</span><span class=nf>TransactionByHash</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>Background</span><span class=p>(),</span> <span class=nx>txHash</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>rawTXBytes</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>tx</span><span class=p>.</span><span class=nf>MarshalBinary</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Raw data =&gt;&#34;</span><span class=p>,</span> <span class=nx>common</span><span class=p>.</span><span class=nf>Bytes2Hex</span><span class=p>(</span><span class=nx>rawTXBytes</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=nx>v</span><span class=p>,</span> <span class=nx>r</span><span class=p>,</span> <span class=nx>s</span> <span class=o>:=</span> <span class=nx>tx</span><span class=p>.</span><span class=nf>RawSignatureValues</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=c1>//fmt.Println(recoverPlain(a.Hash(), r, s, v, true))
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=kd>var</span> <span class=nx>z</span> <span class=nx>types</span><span class=p>.</span><span class=nx>FrontierSigner</span>
</span></span><span class=line><span class=cl>	<span class=nx>calculatedSenderAddress</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nf>recoverPlain</span><span class=p>(</span><span class=nx>z</span><span class=p>.</span><span class=nf>Hash</span><span class=p>(</span><span class=nx>tx</span><span class=p>),</span> <span class=nx>r</span><span class=p>,</span> <span class=nx>s</span><span class=p>,</span> <span class=nx>v</span><span class=p>,</span> <span class=kc>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Calculated sender address =&gt;&#34;</span><span class=p>,</span> <span class=nx>calculatedSenderAddress</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// recoverPlain attempts to recover the public key from the signature.
</span></span></span><span class=line><span class=cl><span class=c1>// From https://github.com/ethereum/go-ethereum/blob/4b309c70065e68321f6ba518f35b0454a5c929a9/core/types/transaction_signing.go#L482
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>recoverPlain</span><span class=p>(</span><span class=nx>sighash</span> <span class=nx>common</span><span class=p>.</span><span class=nx>Hash</span><span class=p>,</span> <span class=nx>R</span><span class=p>,</span> <span class=nx>S</span><span class=p>,</span> <span class=nx>Vb</span> <span class=o>*</span><span class=nx>big</span><span class=p>.</span><span class=nx>Int</span><span class=p>,</span> <span class=nx>homestead</span> <span class=kt>bool</span><span class=p>)</span> <span class=p>(</span><span class=nx>common</span><span class=p>.</span><span class=nx>Address</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>Vb</span><span class=p>.</span><span class=nf>BitLen</span><span class=p>()</span> <span class=p>&gt;</span> <span class=mi>8</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=nx>common</span><span class=p>.</span><span class=nx>Address</span><span class=p>{},</span> <span class=nx>errors</span><span class=p>.</span><span class=nf>New</span><span class=p>(</span><span class=s>&#34;Invalid Sig&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>V</span> <span class=o>:=</span> <span class=nb>byte</span><span class=p>(</span><span class=nx>Vb</span><span class=p>.</span><span class=nf>Uint64</span><span class=p>()</span> <span class=o>-</span> <span class=mi>27</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=p>!</span><span class=nx>crypto</span><span class=p>.</span><span class=nf>ValidateSignatureValues</span><span class=p>(</span><span class=nx>V</span><span class=p>,</span> <span class=nx>R</span><span class=p>,</span> <span class=nx>S</span><span class=p>,</span> <span class=nx>homestead</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=nx>common</span><span class=p>.</span><span class=nx>Address</span><span class=p>{},</span> <span class=nx>errors</span><span class=p>.</span><span class=nf>New</span><span class=p>(</span><span class=s>&#34;Invalid Sig&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=c1>// encode the signature in uncompressed format
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>r</span><span class=p>,</span> <span class=nx>s</span> <span class=o>:=</span> <span class=nx>R</span><span class=p>.</span><span class=nf>Bytes</span><span class=p>(),</span> <span class=nx>S</span><span class=p>.</span><span class=nf>Bytes</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=nx>sig</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span> <span class=nx>crypto</span><span class=p>.</span><span class=nx>SignatureLength</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nb>copy</span><span class=p>(</span><span class=nx>sig</span><span class=p>[</span><span class=mi>32</span><span class=o>-</span><span class=nb>len</span><span class=p>(</span><span class=nx>r</span><span class=p>):</span><span class=mi>32</span><span class=p>],</span> <span class=nx>r</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nb>copy</span><span class=p>(</span><span class=nx>sig</span><span class=p>[</span><span class=mi>64</span><span class=o>-</span><span class=nb>len</span><span class=p>(</span><span class=nx>s</span><span class=p>):</span><span class=mi>64</span><span class=p>],</span> <span class=nx>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>sig</span><span class=p>[</span><span class=mi>64</span><span class=p>]</span> <span class=p>=</span> <span class=nx>V</span>
</span></span><span class=line><span class=cl>	<span class=c1>// recover the public key from the signature
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>pub</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>crypto</span><span class=p>.</span><span class=nf>Ecrecover</span><span class=p>(</span><span class=nx>sighash</span><span class=p>[:],</span> <span class=nx>sig</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Recovered public key =&gt;&#34;</span><span class=p>,</span> <span class=nx>common</span><span class=p>.</span><span class=nf>Bytes2Hex</span><span class=p>(</span><span class=nx>pub</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=nx>common</span><span class=p>.</span><span class=nx>Address</span><span class=p>{},</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nx>pub</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>||</span> <span class=nx>pub</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>4</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=nx>common</span><span class=p>.</span><span class=nx>Address</span><span class=p>{},</span> <span class=nx>errors</span><span class=p>.</span><span class=nf>New</span><span class=p>(</span><span class=s>&#34;invalid public key&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>addr</span> <span class=nx>common</span><span class=p>.</span><span class=nx>Address</span>
</span></span><span class=line><span class=cl>	<span class=nb>copy</span><span class=p>(</span><span class=nx>addr</span><span class=p>[:],</span> <span class=nx>crypto</span><span class=p>.</span><span class=nf>Keccak256</span><span class=p>(</span><span class=nx>pub</span><span class=p>[</span><span class=mi>1</span><span class=p>:])[</span><span class=mi>12</span><span class=p>:])</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>addr</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>Recovered public key =&gt; 040313073748ea0af8e0782adae7c15f2bd46b5179dab5a200307a41868b9dade1fd7eebc17da98c8d2065e429b1fd05e7651e08bda5b279254530f5b00f4487f2
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Calculated sender address =&gt; 0xcF9A54585b20041aC1265Ad64cE21d09fD4b1324
</span></span></code></pre></td></tr></table></div></div><p>You can notice, that to convert the public key to an address, the first bytes (two characters) are ignored. This is because the <code>04</code> is a tag bytes for the ASN.1 OCTET String structure.</p><p>We can check the public key by sending it the contract with the <code>cast</code> command of the foundry binaries.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cast send 0x9Eb8F52b22024003C1312ea1569cf14208f3c30A <span class=s2>&#34;isPublicKey(bytes)&#34;</span> <span class=s2>&#34;0313073748ea0af8e0782adae7c15f2bd46b5179dab5a200307a41868b9dade1fd7eebc17da98c8d2065e429b1fd05e7651e08bda5b279254530f5b00f4487f2&#34;</span> --rpc-url http://localhost:8545  --private-key 0x.....
</span></span></code></pre></td></tr></table></div></div></section><footer class=article-footer><section class=article-tags><a href=/tags/foundry/>foundry</a>
<a href=/tags/solidity/>solidity</a>
<a href=/tags/golang/>golang</a>
<a href=/tags/web3/>web3</a></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/writeup-404ctf-2022-contracts-war-1-web3/><div class=article-image><img src=/images/404CTF.png loading=lazy data-key data-hash=/images/404CTF.png></div><div class=article-details><h2 class=article-title>Writeup 404CTF 2022 - Contracts war 1 (web3)</h2></div></a></article><article class=has-image><a href=/p/writeup-404ctf-2022-contracts-war-2-web3/><div class=article-image><img src=/images/404CTF.png loading=lazy data-key data-hash=/images/404CTF.png></div><div class=article-details><h2 class=article-title>Writeup 404CTF 2022 - Contracts war 2 (web3)</h2></div></a></article><article class=has-image><a href=/p/ethernaut-challenges/><div class=article-image><img src=/images/openzeppelin-logo.svg loading=lazy data-key data-hash=/images/openzeppelin-logo.svg></div><div class=article-details><h2 class=article-title>Ethernaut challenges</h2></div></a></article><article class=has-image><a href=/p/ethernaut-challenges-0.-hello-ethernaut/><div class=article-image><img src=/images/openzeppelin-logo.svg loading=lazy data-key data-hash=/images/openzeppelin-logo.svg></div><div class=article-details><h2 class=article-title>Ethernaut challenges - 0. Hello Ethernaut</h2></div></a></article><article class=has-image><a href=/p/ethernaut-challenges-1.-fallback/><div class=article-image><img src=/images/openzeppelin-logo.svg loading=lazy data-key data-hash=/images/openzeppelin-logo.svg></div><div class=article-details><h2 class=article-title>Ethernaut challenges - 1. Fallback</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2022 Nodauf</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.12.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script><script async src=//static.getclicky.com/101374543.js></script><noscript><p><img alt=Clicky width=1 height=1 src=//in.getclicky.com/101374543ns.gif></p></noscript></body></html>